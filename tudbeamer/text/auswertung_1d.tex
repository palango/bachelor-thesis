\section{Eindimensionale Testfälle}

\paragraph{Testfall 1}
\noindent
Der erste Testfall ist ein reines Diffusionsproblem auf kartesischem
Gitter. Die Testfunktion ist Nummer~2 (siehe Abbildung~\ref{fig:testfn2}).
Die Anzahl der Kontrollvolumen beträgt $N=20$ und der Diffusionskoeffizient
ist $D = 1$.
\begin{figure}[ht]
\centering
   \begin{subfigure}{0.49\linewidth} \centering
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth, scaled y ticks=true,
    xlabel=$x$,
    ylabel=Absoluter Fehler]
      \addplot[tud2d, mark=*, very thick] file {data/1/1_cos_aqui_err.txt};
    \end{axis}
  \end{tikzpicture}
     \caption{Absoluter Fehler}
   \end{subfigure}
   \begin{subfigure}{0.49\linewidth} \centering
     \vspace{15pt}
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth, scaled y ticks=true,
    xlabel=$x$,
    ylabel=Residuum/Abbruchfehler]
      \addplot[tud9c, mark=*, very thick] file {data/1/1_cos_aqui_te.txt};
      \addplot[tud2d, mark=*, very thick] file {data/1/1_cos_aqui_res.txt};
      \legend{Abbruchfehler, Residuum}
    \end{axis}
  \end{tikzpicture}
  \caption{Residuum der Lösung und Abbruchfehler}
   \end{subfigure}
   \caption{Lösungseigenschaften (Testfall 1)}
\end{figure}
Man sieht gut das der absolute Lösungsfehler schon bei zwanzig Kontrollvolumen klein ist.
Außerdem hat das Residuum am Rand Sprünge. Diese werden auch vom Abbruchfehlerindikator abgebildet,
durch die Verwendung einseitiger Differenzenquotienten jedoch mit verringerter Genauigkeit.
Die Sprünge werden in den folgenden Diagrammen teilweise ausgeblendet um
Residuum und Abbruchfehler besser vergleichen zu können.

\begin{figure}[ht]
\centering
   \begin{subfigure}{0.49\linewidth} \centering
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth,
    xlabel=$x$,
    ylabel=RES--TE]
      \addplot[tud2d, mark=*, very thick] file {data/1/1_cos_aqui_teres.txt};
    \end{axis}
  \end{tikzpicture}
  \caption{Mit Randsprüngen}
   \end{subfigure}
   \begin{subfigure}{0.49\linewidth} \centering
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth,
    xlabel=$x$,
    ylabel=RES--TE]
      \addplot[tud2d, mark=*, very thick] file {data/1/1_cos_aqui_teres2.txt};
    \end{axis}
  \end{tikzpicture}
  \caption{Ohne Randsprünge}
   \end{subfigure}
   \caption{Differenz Residuum und Abbruchfehler (Testfall 1)}
\end{figure}
\noindent
Auf feineren Gittern erwartet man einen kleineren Abbruchfehler. Dies
wird durch die folgenden Diagramme bestätigt, in denen der Abbruchfehler auf
Gittern mit $N=10$ und $N=40$ mit dem Abbruchfehler des Testfalles verglichen werden.
Die Verbesserung beträgt ungefähr eine halbe Ordnung pro Verdoppelung der Schrittweite.
\begin{figure}[ht]
\centering
\begin{tikzpicture}
  \begin{axis}[width=0.7\textwidth, scaled y ticks=false,
  xlabel=$x$,
  ylabel=Abbruchfehler]
    \addplot[tud2d, mark=*, very thick] file {data/1/1_cos_aqui_te2.txt};
    %\addplot[tud2d, mark=+, thick] file {data/1/1_cos_aqui_res2.txt};
  \end{axis}
\end{tikzpicture}
\caption{Abbruchfehler ohne Randsprünge (Testfall 1)}
\end{figure}
\begin{figure}[ht]
\centering
   \begin{subfigure}{0.49\linewidth} \centering
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth,
    xlabel=$x$,
    ylabel=Abbruchfehler]
      \addplot[tud2d, mark=*, very thick] file {data/5/cos_kart_10.txt};
    \end{axis}
  \end{tikzpicture}
  \caption{N=10}\label{fig:figA}
   \end{subfigure}
   \begin{subfigure}{0.49\linewidth} \centering
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth,
    xlabel=$x$,
    ylabel=Abbruchfehler]
      \addplot[tud2d, mark=*, very thick] file {data/5/cos_kart_40.txt};
    \end{axis}
  \end{tikzpicture}
  \caption{N=40}\label{fig:figB}
   \end{subfigure}
   \caption{Abbruchfehler ohne Randsprünge für veränderte Gitter (Testfall 1)}
\end{figure}

\vspace{2cm}


\paragraph{Testfall 2}
\noindent
Der zweite Testfall verwendet Testfunktion 1 auf einem orthogonalen Gitter mit
Expansionsfaktor $\alpha=0,9$. Es gibt wieder zwanzig Kontrollvolumen.

\begin{figure}[ht]
\centering
   \begin{subfigure}{0.49\linewidth} \centering
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth,
    xlabel=$x$,
    ylabel=Absoluter Fehler]
      \addplot[tud2d, mark=*, very thick] file {data/2/2_sin_var_err.txt};
    \end{axis}
  \end{tikzpicture}
     \caption{Absoluter Fehler}
   \end{subfigure}
   \begin{subfigure}{0.49\linewidth} \centering
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth,
    xlabel=$x$,
    ylabel=Residuum/Abbruchfehler]
      \addplot[tud9c, mark=*, very thick] file {data/2/2_sin_var_te.txt};
      \addplot[tud2d, mark=*, very thick] file {data/2/2_sin_var_res.txt};
      \legend{Abbruchfehler, Residuum}
    \end{axis}
  \end{tikzpicture}
  \caption{Residuum der Lösung und Abbruchfehler}
   \end{subfigure}
   \caption{Lösungseigenschaften (Testfall 2)}
\end{figure}
\noindent
Die Abhängigkeit des absoluten Fehlers vom Gitter ist gut zu erkennen. Im groben
Bereich steigt der Fehler, während er im fein aufgelösten Bereich sinkt.
Auch Abbruchfehler und Residuum stimmen gut überein. Die verminderte Genauigkeit
der einseitigen Differenzenquotienten am Rand bewirkt wieder Abweichungen an den Rändern.
%\begin{figure}[ht]
%\centering
%\begin{tikzpicture}
  %\begin{axis}[width=0.7\textwidth]
  %%xlabel=$x$,
  %%ylabel=$y$]
    %\addplot[tud2d, mark=*, very thick] file {data/2/2_sin_var_te2.txt};
    %%\addplot[tud2d, mark=+, thick] file {data/2/2_sin_var_res2.txt};
  %\end{axis}
%\end{tikzpicture}
%\caption{Abbruchfehler ohne Randsprünge} \label{fig:twofigs}
%\end{figure}
\begin{figure}[ht]
\centering
   \begin{subfigure}{0.49\linewidth} \centering
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth,
    xlabel=$x$,
    ylabel=RES--TE]
      \addplot[tud2d, mark=*, very thick] file {data/2/2_sin_var_teres.txt};
    \end{axis}
  \end{tikzpicture}
  \caption{Mit Randsprüngen}
   \end{subfigure}
   \begin{subfigure}{0.49\linewidth} \centering
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth,
    xlabel=$x$,
    ylabel=RES--TE]
      \addplot[tud2d, mark=*, very thick] file {data/2/2_sin_var_teres2.txt};
    \end{axis}
  \end{tikzpicture}
  \caption{Ohne Randsprünge}
   \end{subfigure}
   \caption{Differenz Residuum und Abbruchfehler (Testfall 2)}
\end{figure}

Eine weitere Bedingung ist, dass der Abbruchfehler unabhängig von
Diffusions- und Konvektionskoeffizient ist. Dazu wird jeweils einer der beiden Koeffizienten
um eine Ordnung vergrößert. Die Ergebnisse sind in den folgenden Diagrammen zu sehen.
Man erkennt, das die Genauigkeit im Vergleich zu Koeffizienten gleicher Größe
um etwa eine Größenordnung abnimmt.
\begin{figure}[ht]
\centering
   \begin{subfigure}{0.49\linewidth} \centering
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth,
    xlabel=$x$,
    ylabel=RES--TE]
      \addplot[tud2d, mark=*, very thick] file {data/5/sin_orth_DIF10.txt};
    \end{axis}
  \end{tikzpicture}
  \caption{DIV=10, KONV=1}
   \end{subfigure}
   \begin{subfigure}{0.49\linewidth} \centering
  \begin{tikzpicture}
    \begin{axis}[width=\textwidth,
    xlabel=$x$,
    ylabel=RES--TE]
      \addplot[tud2d, mark=*, very thick] file {data/5/sin_orth_KONV10.txt};
    \end{axis}
  \end{tikzpicture}
  \caption{DIF=1, KONV=10}
   \end{subfigure}
   \caption{Differenz Residuum und Abbruchfehler mit angepassten Koeffizienten (Testfall 2)}
\end{figure}
\clearpage
